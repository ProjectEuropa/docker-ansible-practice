version: "3.7"
services:
  # node 1
  centos7:
    build:
      context: ./nodes/centos7
      dockerfile: Dockerfile
    image: ansible-centos7
    container_name: ansible-centos7
    hostname: centos7
    privileged: true
    volumes:
      - ./ssh/ansible_rsa.pub:/root/.ssh/authorized_keys
  # node 2
  ubuntu20:
    build:
      context: ./nodes/ubuntu20
      dockerfile: Dockerfile
    image: ansible-ubuntu20
    container_name: ansible-ubuntu20
    hostname: ubuntu20
    privileged: true
    working_dir: /home/work_user
  # ansible実行環境
  myansible:
    build:
      context: .
      dockerfile: Dockerfile
    image: myansible
    container_name: myansible
    hostname: myansible
    tty: true
    volumes:
      - ./playbooks:/myansible
    working_dir: /myansible
